import { PrismaClient } from '@prisma/client';
import bcryptjs from 'bcryptjs';

const prisma = new PrismaClient();

const mockProperties = [
  {
    address: '1234 Oak Street',
    city: 'Austin',
    state: 'TX',
    zipCode: '78701',
    type: 'rent',
    status: 'owned',
    purchasePrice: 385000,
    currentValue: 425000,
    arv: 450000,
    sqft: 1850,
    bedrooms: 3,
    bathrooms: 2,
    yearBuilt: 1998,
    lotSize: 0.15,
    latitude: 30.2672,
    longitude: -97.7431,
  },
  {
    address: '5678 Pine Avenue',
    city: 'Denver',
    state: 'CO',
    zipCode: '80202',
    type: 'airbnb',
    status: 'owned',
    purchasePrice: 520000,
    currentValue: 575000,
    arv: 600000,
    sqft: 2200,
    bedrooms: 4,
    bathrooms: 3,
    yearBuilt: 2015,
    lotSize: 0.12,
    latitude: 39.7392,
    longitude: -104.9903,
  },
  {
    address: '9012 Maple Drive',
    city: 'Phoenix',
    state: 'AZ',
    zipCode: '85001',
    type: 'flip',
    status: 'under_contract',
    purchasePrice: 275000,
    currentValue: 275000,
    arv: 385000,
    sqft: 1650,
    bedrooms: 3,
    bathrooms: 2,
    yearBuilt: 1985,
    lotSize: 0.18,
    latitude: 33.4484,
    longitude: -112.0740,
  },
  {
    address: '3456 Cedar Lane',
    city: 'Nashville',
    state: 'TN',
    zipCode: '37201',
    type: 'rent',
    status: 'owned',
    purchasePrice: 340000,
    currentValue: 380000,
    arv: 395000,
    sqft: 1720,
    bedrooms: 3,
    bathrooms: 2,
    yearBuilt: 2010,
    lotSize: 0.14,
    latitude: 36.1627,
    longitude: -86.7816,
  },
  {
    address: '7890 Birch Court',
    city: 'Tampa',
    state: 'FL',
    zipCode: '33601',
    type: 'airbnb',
    status: 'analyzing',
    purchasePrice: 425000,
    currentValue: 425000,
    arv: 480000,
    sqft: 1950,
    bedrooms: 4,
    bathrooms: 2.5,
    yearBuilt: 2018,
    lotSize: 0.11,
    latitude: 27.9506,
    longitude: -82.4572,
  },
  {
    address: '2345 Elm Street',
    city: 'Charlotte',
    state: 'NC',
    zipCode: '28201',
    type: 'flip',
    status: 'offer',
    purchasePrice: 195000,
    currentValue: 195000,
    arv: 295000,
    sqft: 1400,
    bedrooms: 3,
    bathrooms: 1.5,
    yearBuilt: 1972,
    lotSize: 0.20,
    latitude: 35.2271,
    longitude: -80.8431,
  },
  {
    address: '6789 Willow Way',
    city: 'San Antonio',
    state: 'TX',
    zipCode: '78201',
    type: 'rent',
    status: 'lead',
    purchasePrice: 265000,
    currentValue: 265000,
    arv: 290000,
    sqft: 1550,
    bedrooms: 3,
    bathrooms: 2,
    yearBuilt: 2005,
    lotSize: 0.16,
    latitude: 29.4241,
    longitude: -98.4936,
  },
  {
    address: '4567 Spruce Boulevard',
    city: 'Raleigh',
    state: 'NC',
    zipCode: '27601',
    type: 'airbnb',
    status: 'owned',
    purchasePrice: 395000,
    currentValue: 445000,
    arv: 465000,
    sqft: 2100,
    bedrooms: 4,
    bathrooms: 3,
    yearBuilt: 2020,
    lotSize: 0.10,
    latitude: 35.7796,
    longitude: -78.6382,
  },
  {
    address: '8901 Aspen Road',
    city: 'Salt Lake City',
    state: 'UT',
    zipCode: '84101',
    type: 'flip',
    status: 'analyzing',
    purchasePrice: 310000,
    currentValue: 310000,
    arv: 425000,
    sqft: 1800,
    bedrooms: 4,
    bathrooms: 2,
    yearBuilt: 1990,
    lotSize: 0.22,
    latitude: 40.7608,
    longitude: -111.8910,
  },
  {
    address: '1357 Redwood Circle',
    city: 'Portland',
    state: 'OR',
    zipCode: '97201',
    type: 'rent',
    status: 'owned',
    purchasePrice: 485000,
    currentValue: 520000,
    arv: 540000,
    sqft: 2400,
    bedrooms: 4,
    bathrooms: 2.5,
    yearBuilt: 2012,
    lotSize: 0.13,
    latitude: 45.5152,
    longitude: -122.6784,
  },
  {
    address: '2468 Sequoia Street',
    city: 'Las Vegas',
    state: 'NV',
    zipCode: '89101',
    type: 'airbnb',
    status: 'owned',
    purchasePrice: 375000,
    currentValue: 410000,
    arv: 430000,
    sqft: 1900,
    bedrooms: 3,
    bathrooms: 2,
    yearBuilt: 2016,
    lotSize: 0.09,
    latitude: 36.1699,
    longitude: -115.1398,
  },
  {
    address: '3579 Palm Avenue',
    city: 'Miami',
    state: 'FL',
    zipCode: '33101',
    type: 'flip',
    status: 'lead',
    purchasePrice: 450000,
    currentValue: 450000,
    arv: 625000,
    sqft: 2200,
    bedrooms: 4,
    bathrooms: 3,
    yearBuilt: 1988,
    lotSize: 0.17,
    latitude: 25.7617,
    longitude: -80.1918,
  },
  {
    address: '4680 Magnolia Lane',
    city: 'Atlanta',
    state: 'GA',
    zipCode: '30301',
    type: 'rent',
    status: 'under_contract',
    purchasePrice: 295000,
    currentValue: 295000,
    arv: 340000,
    sqft: 1600,
    bedrooms: 3,
    bathrooms: 2,
    yearBuilt: 2008,
    lotSize: 0.14,
    latitude: 33.7490,
    longitude: -84.3880,
  },
  {
    address: '5791 Cypress Drive',
    city: 'Dallas',
    state: 'TX',
    zipCode: '75201',
    type: 'airbnb',
    status: 'analyzing',
    purchasePrice: 355000,
    currentValue: 355000,
    arv: 400000,
    sqft: 1750,
    bedrooms: 3,
    bathrooms: 2,
    yearBuilt: 2014,
    lotSize: 0.11,
    latitude: 32.7767,
    longitude: -96.7970,
  },
  {
    address: '6802 Hickory Court',
    city: 'Seattle',
    state: 'WA',
    zipCode: '98101',
    type: 'rent',
    status: 'owned',
    purchasePrice: 625000,
    currentValue: 680000,
    arv: 710000,
    sqft: 2800,
    bedrooms: 5,
    bathrooms: 3,
    yearBuilt: 2019,
    lotSize: 0.15,
    latitude: 47.6062,
    longitude: -122.3321,
  },
  {
    address: '7913 Chestnut Place',
    city: 'Indianapolis',
    state: 'IN',
    zipCode: '46201',
    type: 'flip',
    status: 'offer',
    purchasePrice: 155000,
    currentValue: 155000,
    arv: 245000,
    sqft: 1350,
    bedrooms: 3,
    bathrooms: 1.5,
    yearBuilt: 1965,
    lotSize: 0.19,
    latitude: 39.7684,
    longitude: -86.1581,
  },
  {
    address: '8024 Walnut Way',
    city: 'Columbus',
    state: 'OH',
    zipCode: '43201',
    type: 'rent',
    status: 'lead',
    purchasePrice: 225000,
    currentValue: 225000,
    arv: 260000,
    sqft: 1480,
    bedrooms: 3,
    bathrooms: 2,
    yearBuilt: 2000,
    lotSize: 0.16,
    latitude: 39.9612,
    longitude: -82.9988,
  },
  {
    address: '9135 Sycamore Boulevard',
    city: 'Kansas City',
    state: 'MO',
    zipCode: '64101',
    type: 'airbnb',
    status: 'owned',
    purchasePrice: 285000,
    currentValue: 315000,
    arv: 335000,
    sqft: 1700,
    bedrooms: 3,
    bathrooms: 2,
    yearBuilt: 2011,
    lotSize: 0.12,
    latitude: 39.0997,
    longitude: -94.5786,
  },
  {
    address: '1046 Poplar Road',
    city: 'Minneapolis',
    state: 'MN',
    zipCode: '55401',
    type: 'flip',
    status: 'under_contract',
    purchasePrice: 235000,
    currentValue: 235000,
    arv: 345000,
    sqft: 1580,
    bedrooms: 3,
    bathrooms: 2,
    yearBuilt: 1978,
    lotSize: 0.21,
    latitude: 44.9778,
    longitude: -93.2650,
  },
  {
    address: '2157 Alder Street',
    city: 'Boise',
    state: 'ID',
    zipCode: '83701',
    type: 'rent',
    status: 'analyzing',
    purchasePrice: 345000,
    currentValue: 345000,
    arv: 385000,
    sqft: 1820,
    bedrooms: 4,
    bathrooms: 2.5,
    yearBuilt: 2017,
    lotSize: 0.14,
    latitude: 43.6150,
    longitude: -116.2023,
  },
];

async function main() {
  console.log('Starting database seed...');

  // Create test user
  const hashedPassword = await bcryptjs.hash('password123', 10);
  const user = await prisma.user.upsert({
    where: { email: 'test@propertypilot.com' },
    update: {},
    create: {
      email: 'test@propertypilot.com',
      password: hashedPassword,
      name: 'Test User',
      currency: 'USD',
      timezone: 'America/New_York',
      preferences: {
        create: {
          currency: 'USD',
          timezone: 'America/New_York',
        },
      },
    },
  });

  console.log(`Created/updated user: ${user.email}`);

  // Create properties
  for (const prop of mockProperties) {
    await prisma.property.create({
      data: {
        ...prop,
        userId: user.id,
      },
    });
  }

  console.log('✓ Created 20 mock properties');

  // Create some deal scenarios
  const firstProperty = await prisma.property.findFirst({
    where: { userId: user.id, type: 'flip' },
  });

  if (firstProperty) {
    await prisma.dealScenario.create({
      data: {
        propertyId: firstProperty.id,
        name: 'Conservative Flip',
        purchasePrice: 275000,
        rehabCost: 65000,
        holdingCosts: 12000,
        closingCosts: 15000,
        interestRate: 7.5,
        holdTimeMonths: 6,
        exitStrategy: 'flip',
        salePrice: 385000,
        sellingCosts: 23100,
        capRate: 0,
        cashOnCash: 22.5,
        roi: 22.5,
        monthlyNOI: 0,
        totalProfit: 75900,
        irr: 45,
        npv: 75900,
      },
    });

    console.log('✓ Created sample deal scenario');
  }

  // Create some alerts
  await prisma.alert.create({
    data: {
      userId: user.id,
      type: 'success',
      title: 'Database Seeded',
      message: 'All mock data has been loaded successfully',
      read: false,
    },
  });

  console.log('✓ Created sample alert');
  console.log('\n✓ Database seed completed successfully!');
  console.log(`Test user email: test@propertypilot.com`);
  console.log(`Test user password: password123`);
}

main()
  .catch((e) => {
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
